p8105_hw5_tc3326
================
KK Chen
2024-11-15

# Problem 2

### Set Parameters and Simulate Data

``` r
simulate_t_test = function(true_mean, sample_size = 30, std_dev = 5) 
  {
  simulated_data = tibble(sample_values = rnorm(sample_size, true_mean, std_dev))
  t_test_result = t.test(simulated_data$sample_values, mu = 0)
  cleaned_result = broom::tidy(t_test_result)
  
  result = tibble(
    sample_mean = cleaned_result$estimate,
    p_value = cleaned_result$p.value,
  )
  
  return(result)
  }
```

``` r
simulation_results_mu_0 = 
  tibble(iter = 1:5000) %>%
  mutate(simulation_output = map(iter, ~simulate_t_test(true_mean = 0))) %>%
  unnest(simulation_output)

simulation_results_mu_0
```

    ## # A tibble: 5,000 × 3
    ##     iter sample_mean p_value
    ##    <int>       <dbl>   <dbl>
    ##  1     1       0.853  0.386 
    ##  2     2      -0.527  0.511 
    ##  3     3       1.42   0.0725
    ##  4     4      -1.04   0.292 
    ##  5     5      -1.34   0.156 
    ##  6     6      -0.649  0.550 
    ##  7     7       1.27   0.136 
    ##  8     8      -1.65   0.0470
    ##  9     9      -0.246  0.783 
    ## 10    10      -0.651  0.485 
    ## # ℹ 4,990 more rows

``` r
true_mean_values = c(1, 2, 3, 4, 5, 6)

sim_res_multiple_means = 
  expand_grid(
    true_mean = true_mean_values,
    iter = 1:5000 ) %>%
  mutate(simulation_output = map(true_mean, ~simulate_t_test(true_mean = .x))) %>%
  unnest(simulation_output, names_sep = "_")

sim_res_multiple_means
```

    ## # A tibble: 30,000 × 4
    ##    true_mean  iter simulation_output_sample_mean simulation_output_p_value
    ##        <dbl> <int>                         <dbl>                     <dbl>
    ##  1         1     1                         1.22                     0.173 
    ##  2         1     2                        -0.289                    0.752 
    ##  3         1     3                         1.64                     0.0701
    ##  4         1     4                         1.25                     0.193 
    ##  5         1     5                         1.83                     0.0588
    ##  6         1     6                         1.54                     0.0872
    ##  7         1     7                         1.17                     0.163 
    ##  8         1     8                         0.997                    0.186 
    ##  9         1     9                         0.541                    0.591 
    ## 10         1    10                         0.875                    0.304 
    ## # ℹ 29,990 more rows

### Plot: Power of Test vs. True Mean

``` r
power_plot <- sim_res_multiple_means %>%
  group_by(true_mean) %>%
  summarize(power = mean(simulation_output_p_value < 0.05)) %>%
  ggplot(aes(x = true_mean, y = power)) +
  geom_line() +
  geom_point() +
  labs(
    title = "Power vs. True Mean",
    x = "True Mean (µ)",
    y = "Power (Proportion of Null Rejected)"
  ) +
  theme_minimal()

power_plot
```

![](p8105_hw5_tc3326_files/figure-gfm/unnamed-chunk-4-1.png)<!-- --> \*
As the effect size increases, the power of the test also increases. As
the effect size grows (the difference between the true mean and the null
hypothesis mean of 0 becomes larger), the test becomes more likely to
reject the null hypothesis, resulting in higher power. Also, there is
non-linear growth. The power rises substantially from μ=1 to μ=3.
However, as μ approaches 5 and 6, the power begins to plateau near 1.
This suggests that once the effect size is large enough, almost all
tests reject the null hypothesis, reaching close to 100% power.
